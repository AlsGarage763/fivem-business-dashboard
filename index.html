<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Business Dashboard</title>
<style>
  /* General Reset */
  * {
    box-sizing: border-box;
  }
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    background: #f5f7fa;
    color: #333;
  }
  /* Container */
  #dashboard {
    max-width: 900px;
    margin: 2em auto;
    padding: 1em;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 0 12px rgba(0,0,0,0.1);
  }
  /* Tabs Navigation */
  .tabnav {
    display: flex;
    border-bottom: 2px solid #eee;
    margin-bottom: 1em;
  }
  .tabnav button {
    flex: 1;
    padding: 12px;
    background: #eee;
    border: none;
    border-bottom: 4px solid transparent;
    cursor: pointer;
    font-size: 1em;
    font-weight: 600;
    transition: background 0.3s, border-color 0.3s;
  }
  .tabnav button.active {
    background: #fff;
    border-bottom-color: #007bff;
    color: #007bff;
  }
  .tabnav button:hover:not(.active) {
    background: #ddd;
  }

  /* Tab Content */
  .tabcontent {
    display: none;
  }
  .tabcontent.active {
    display: block;
  }

  /* Forms */
  form.form-group {
    margin-bottom: 1.5em;
    display: flex;
    flex-wrap: wrap;
    gap: 1em;
  }
  form.form-group label {
    flex: 1 0 120px;
    align-self: center;
  }
  form.form-group input,
  form.form-group select {
    flex: 2 0 200px;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
  }
  form.form-group button {
    padding: 10px 20px;
    background: #007bff;
    border: none;
    border-radius: 4px;
    color: white;
    cursor: pointer;
    font-weight: 600;
    transition: background 0.3s;
  }
  form.form-group button:hover {
    background: #0056b3;
  }

  /* Data tables */
  table.data-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 1.5em;
  }
  table.data-table th,
  table.data-table td {
    padding: 10px 12px;
    border: 1px solid #ddd;
    text-align: left;
  }
  table.data-table th {
    background: #f0f0f0;
    font-weight: 700;
  }
  /* Delete button */
  button.delete-btn {
    background: #dc3545;
    border: none;
    color: white;
    padding: 5px 12px;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 600;
    transition: background 0.3s;
  }
  button.delete-btn:hover {
    background: #a71d2a;
  }

  /* Login container */
  #login-container {
    max-width: 360px;
    margin: 5em auto;
    padding: 2em;
    background: white;
    border-radius: 8px;
    box-shadow: 0 0 12px rgba(0,0,0,0.1);
  }
  #login-container h2 {
    text-align: center;
    margin-bottom: 1em;
  }
  #login-container form label {
    display: block;
    margin-bottom: 0.3em;
    font-weight: 600;
  }
  #login-container form input {
    width: 100%;
    padding: 10px;
    margin-bottom: 1.2em;
    border: 1px solid #ccc;
    border-radius: 4px;
  }
  #login-container form button {
    width: 100%;
    padding: 12px;
    background: #007bff;
    border: none;
    border-radius: 6px;
    color: white;
    font-weight: 700;
    cursor: pointer;
    transition: background 0.3s;
  }
  #login-container form button:hover {
    background: #0056b3;
  }

  /* Profit tab specific styles */
  #tax-form {
    margin-bottom: 1em;
    display: flex;
    align-items: center;
  }
  #tax-form label {
    font-weight: 600;
  }
  #tax-input {
    margin-left: 8px;
    width: 80px;
    padding: 6px 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
  }
  #tax-display {
    margin-left: 12px;
    font-weight: 700;
    min-width: 40px;
  }
</style>
</head>
<body>

<!-- LOGIN -->
<div id="login-container">
  <h2>Owner Login</h2>
  <form id="login-form">
    <label for="username">Username</label>
    <input type="text" id="username" autocomplete="username" required />
    <label for="password">Password</label>
    <input type="password" id="password" autocomplete="current-password" required />
    <button type="submit">Login</button>
  </form>
</div>

<!-- DASHBOARD -->
<div id="dashboard" style="display:none;">
  <nav class="tabnav" role="tablist" aria-label="Dashboard Tabs">
    <button class="tablinks active" data-tab="sales-tab" role="tab" aria-selected="true" tabindex="0">Sales</button>
    <button class="tablinks" data-tab="employees-tab" role="tab" aria-selected="false" tabindex="-1">Employees</button>
    <button class="tablinks" data-tab="payroll-tab" role="tab" aria-selected="false" tabindex="-1">Payroll</button>
    <button class="tablinks" data-tab="expenses-tab" role="tab" aria-selected="false" tabindex="-1">Expenses</button>
    <button class="tablinks" data-tab="profit-tab" role="tab" aria-selected="false" tabindex="-1">Profit</button>
  </nav>

  <!-- SALES TAB -->
  <div id="sales-tab" class="tabcontent active" role="tabpanel" tabindex="0">
    <form id="sales-form" class="form-group" aria-label="Add Sales">
      <label for="sale-month">Month (YYYY-MM)</label>
      <input type="month" id="sale-month" required />
      <label for="sale-amount">Amount ($)</label>
      <input type="number" id="sale-amount" min="0" step="0.01" required />
      <button type="submit">Add Sale</button>
    </form>
    <table class="data-table" aria-label="Sales Data">
      <thead>
        <tr><th>Month</th><th>Amount</th><th>Action</th></tr>
      </thead>
      <tbody id="sales-table-body"></tbody>
    </table>
  </div>

  <!-- EMPLOYEES TAB -->
  <div id="employees-tab" class="tabcontent" role="tabpanel" tabindex="0">
    <form id="employees-form" class="form-group" aria-label="Add Employee">
      <label for="employee-name">Name</label>
      <input type="text" id="employee-name" required />
      <label for="employee-hire-date">Hire Date</label>
      <input type="date" id="employee-hire-date" required />
      <label for="employee-gender">Gender</label>
      <select id="employee-gender" required>
        <option value="">Select</option>
        <option value="Male">Male</option>
        <option value="Female">Female</option>
      </select>
      <label for="employee-logs">Logs</label>
      <input type="number" id="employee-logs" min="0" step="1" required />
      <button type="submit">Add Employee</button>
    </form>
    <table class="data-table" aria-label="Employees Data">
      <thead>
        <tr><th>Name</th><th>Hire Date</th><th>Gender</th><th>Logs</th><th>Action</th></tr>
      </thead>
      <tbody id="employees-table-body"></tbody>
    </table>
  </div>

  <!-- PAYROLL TAB -->
  <div id="payroll-tab" class="tabcontent" role="tabpanel" tabindex="0">
    <table class="data-table" aria-label="Payroll Data">
      <thead>
        <tr><th>Name</th><th>Logs</th><th>Pay Per Log ($)</th><th>Total Pay ($)</th></tr>
      </thead>
      <tbody id="payroll-table-body"></tbody>
      <tfoot>
        <tr><th colspan="3" style="text-align:right;">Total Payroll</th><th id="payroll-total">$0.00</th></tr>
      </tfoot>
    </table>
  </div>

  <!-- EXPENSES TAB -->
  <div id="expenses-tab" class="tabcontent" role="tabpanel" tabindex="0">
    <form id="expenses-form" class="form-group" aria-label="Add Expense">
      <label for="expense-date">Date</label>
      <input type="date" id="expense-date" required />
      <label for="expense-amount">Amount ($)</label>
      <input type="number" id="expense-amount" min="0" step="0.01" required />
      <label for="expense-desc">Description</label>
      <input type="text" id="expense-desc" required />
      <button type="submit">Add Expense</button>
    </form>
    <table class="data-table" aria-label="Expenses Data">
      <thead>
        <tr><th>Date</th><th>Amount</th><th>Description</th><th>Action</th></tr>
      </thead>
      <tbody id="expenses-table-body"></tbody>
    </table>
  </div>

  <!-- PROFIT TAB -->
  <div id="profit-tab" class="tabcontent" role="tabpanel" tabindex="0">
    <form id="tax-form" aria-label="Set Tax Percentage">
      <label for="tax-input">Tax Percentage (%):</label>
      <input type="number" id="tax-input" min="0" max="100" step="0.1" value="0" aria-describedby="tax-display" />
      <span id="tax-display" aria-live="polite" aria-atomic="true" style="margin-left: 12px; font-weight: 700;">0.0</span>
    </form>
    <table class="data-table" aria-label="Profit Summary">
      <thead>
        <tr><th>Metric</th><th>Amount ($)</th></tr>
      </thead>
      <tbody>
        <tr><td>Gross Sales</td><td id="profit-gross">$0.00</td></tr>
        <tr><td>Expenses</td><td id="profit-expenses">$0.00</td></tr>
        <tr><td>Payroll</td><td id="profit-payroll">$0.00</td></tr>
        <tr><td>Tax</td><td id="profit-tax">$0.00</td></tr>
        <tr><th>Net Profit</th><th id="profit-net">$0.00</th></tr>
      </tbody>
    </table>
  </div>
</div>

<script>
(() => {
  // Elements
  const loginContainer = document.getElementById('login-container');
  const loginForm = document.getElementById('login-form');
  const dashboard = document.getElementById('dashboard');
  const tabs = [...document.querySelectorAll('.tabnav button')];
  const tabContents = [...document.querySelectorAll('.tabcontent')];

  // Sales elements
  const salesForm = document.getElementById('sales-form');
  const salesTableBody = document.getElementById('sales-table-body');

  // Employees elements
  const employeesForm = document.getElementById('employees-form');
  const employeesTableBody = document.getElementById('employees-table-body');

  // Payroll elements
  const payrollTableBody = document.getElementById('payroll-table-body');
  const payrollTotalElem = document.getElementById('payroll-total');

  // Expenses elements
  const expensesForm = document.getElementById('expenses-form');
  const expensesTableBody = document.getElementById('expenses-table-body');

  // Profit elements
  const taxInput = document.getElementById('tax-input');
  const taxDisplay = document.getElementById('tax-display');
  const profitGrossElem = document.getElementById('profit-gross');
  const profitExpensesElem = document.getElementById('profit-expenses');
  const profitPayrollElem = document.getElementById('profit-payroll');
  const profitTaxElem = document.getElementById('profit-tax');
  const profitNetElem = document.getElementById('profit-net');

  // Data storage keys
  const STORAGE_KEYS = {
    sales: 'dashboard_sales',
    employees: 'dashboard_employees',
    expenses: 'dashboard_expenses'
  };

  // Data arrays
  let sales = [];
  let employees = [];
  let expenses = [];

  // Format money with commas and 2 decimals
  function formatMoney(num) {
    return num.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
  }

  // Save/load to localStorage
  function saveData(key, data) {
    localStorage.setItem(key, JSON.stringify(data));
  }
  function loadData(key) {
    const data = localStorage.getItem(key);
    return data ? JSON.parse(data) : [];
  }

  // Tab switching logic
  tabs.forEach(btn => {
    btn.addEventListener('click', () => {
      // Set active button
      tabs.forEach(t => {
        t.classList.remove('active');
        t.setAttribute('aria-selected', 'false');
        t.tabIndex = -1;
      });
      btn.classList.add('active');
      btn.setAttribute('aria-selected', 'true');
      btn.tabIndex = 0;
      btn.focus();

      // Show tab content
      const tabId = btn.dataset.tab;
      tabContents.forEach(tc => {
        if (tc.id === tabId) {
          tc.classList.add('active');
          tc.style.display = 'block';
          tc.focus();
        } else {
          tc.classList.remove('active');
          tc.style.display = 'none';
        }
      });
    });
  });

  // --- SALES ---
  function renderSales() {
    salesTableBody.innerHTML = '';
    sales.forEach(({ id, month, amount }) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${month}</td>
        <td>$${formatMoney(amount)}</td>
        <td><button class="delete-btn" aria-label="Delete sale for ${month}" data-id="${id}">Delete</button></td>
      `;
      salesTableBody.appendChild(tr);
    });
  }
  salesForm.addEventListener('submit', e => {
    e.preventDefault();
    const month = document.getElementById('sale-month').value;
    const amount = parseFloat(document.getElementById('sale-amount').value);
    if (!month || isNaN(amount) || amount < 0) {
      return alert('Please fill out all sales fields correctly.');
    }
    sales.push({ id: Date.now().toString(), month, amount });
    saveData(STORAGE_KEYS.sales, sales);
    renderSales();
    updateProfit();
    salesForm.reset();
  });
  salesTableBody.addEventListener('click', e => {
    if (e.target.classList.contains('delete-btn')) {
      const id = e.target.dataset.id;
      sales = sales.filter(s => s.id !== id);
      saveData(STORAGE_KEYS.sales, sales);
      renderSales();
      updateProfit();
    }
  });

  // --- EMPLOYEES ---
  function renderEmployees() {
    employeesTableBody.innerHTML = '';
    employees.forEach(({ id, name, hireDate, gender, logs }) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${name}</td>
        <td>${hireDate}</td>
        <td>${gender}</td>
        <td>${logs}</td>
        <td><button class="delete-btn" aria-label="Delete employee ${name}" data-id="${id}">Delete</button></td>
      `;
      employeesTableBody.appendChild(tr);
    });
  }
  employeesForm.addEventListener('submit', e => {
    e.preventDefault();
    const name = document.getElementById('employee-name').value.trim();
    const hireDate = document.getElementById('employee-hire-date').value;
    const gender = document.getElementById('employee-gender').value;
    const logs = parseInt(document.getElementById('employee-logs').value, 10);
    if (!name || !hireDate || !gender || isNaN(logs) || logs < 0) {
      return alert('Please fill out all employee fields correctly.');
    }
    employees.push({ id: Date.now().toString(), name, hireDate, gender, logs });
    saveData(STORAGE_KEYS.employees, employees);
    renderEmployees();
    renderPayroll();
    updateProfit();
    employeesForm.reset();
  });
  employeesTableBody.addEventListener('click', e => {
    if (e.target.classList.contains('delete-btn')) {
      const id = e.target.dataset.id;
      employees = employees.filter(emp => emp.id !== id);
      saveData(STORAGE_KEYS.employees, employees);
      renderEmployees();
      renderPayroll();
      updateProfit();
    }
  });

  // --- PAYROLL ---
  function renderPayroll() {
    payrollTableBody.innerHTML = '';
    let totalPayroll = 0;
    employees.forEach(({ id, name, logs }) => {
      const payPerLog = name === "John Delporte" ? 1200 : 100
